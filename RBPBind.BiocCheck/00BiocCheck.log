Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity... OK
Checking R version dependency... OK
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews... OK
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R... OK
Checking NAMESPACE... OK
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory... OK
Checking package installation calls in R code... OK
Checking for library/require of RBPBind... OK
Checking coding practice...
 Avoid 1:...; use seq_len() or seq_along()
Found in files:
utils.R (line 70, column 13)
visualization.R (line 97, column 32)
visualization.R (line 252, column 32)
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths...
The recommended function length is 50 lines or less. There are 11 functions greater than 50 lines.
The longest 5 functions are:
plotBubble() (R/visualization.R): 239 lines
plotBinding() (R/visualization.R): 156 lines
simulateBinding() (R/simulation.R): 150 lines
plotHeatmap() (R/visualization.R): 104 lines
plotGrid() (R/visualization.R):  94 lines
Checking man page documentation... OK
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 126 lines (5%) are > 80 characters long.
First few lines:
R/data_loading.R#L8 #' @param rbp Optional character vector  ...
R/data_loading.R#L76 #' @param models Named list of models (f ...
R/data_loading.R#L77 #' @param max_affinity Named numeric vec ...
R/data_loading.R#L78 #' @param min_affinity Named numeric vec ...
R/equilibrium.R#L6 #' @param protein_totals Vector of total ...
R/equilibrium.R#L49   result <- stats::uniroot(obj_func, int ...
R/export.R#L18 exportResults <- function(results, outpu ...
R/export.R#L22     group_col <- if ("transcript" %in% n ...
R/export.R#L25       exclude <- c("pos", "nt", group_co ...
R/export.R#L27       aggregated <- results[, lapply(.SD ...
R/export.R#L30         seqs <- results[, .(sequence = p ...
R/export.R#L62   group_col <- if ("transcript" %in% nam ...
R/export.R#L63   if (is.null(group_col)) stop("Results  ...
R/export.R#L82   # Use GenomicRanges logic if available ...
R/export.R#L194     stop("SummarizedExperiment package r ...
R/export.R#L203     stop("No RBP columns found. Ensure r ...
R/peaks.R#L17 #' results <- simulateBinding("ACGUACGUA ...
R/peaks.R#L19 #' peaks <- callPeaks(results, rbp_prima ...
R/peaks.R#L31   group_col <- if ("transcript" %in% nam ...
R/peaks.R#L39     if (is.null(rbp_reference)) stop("Re ...
R/peaks.R#L48     dt[, bg := data.table::frollmean(get ...
R/RBPBind-package.R#L4 #' to RNA sequences using an equilibrium ...
R/RBPBind-package.R#L10 #'   \item{Model Loading}{\code{\link{lo ...
R/RBPBind-package.R#L11 #'   \item{Simulation}{\code{\link{simul ...
R/RBPBind-package.R#L24 #' Inherent Specificity and Mutational S ...
R/simulation.R#L6 #' @param rbp_models Named list of data. ...
R/simulation.R#L10 #' @return A data.table containing per-p ...
R/simulation.R#L19 #' results <- simulateBinding(seq, rbp_m ...
R/simulation.R#L23 simulateBinding <- function(sequence, rb ...
R/simulation.R#L27     stop("All RBPs in protein_concs must ...
R/simulation.R#L50       stop("Model for ", rbp, " must be  ...
R/simulation.R#L56       warning("Some motifs in sequence n ...
R/simulation.R#L148       res[[paste0(rbp, "_occupancy_fc")] ...
R/simulation.R#L156         other_dens_sum <- rowSums(res[,  ...
R/simulation.R#L157         other_occ_sum <- rowSums(res[, o ...
R/simulation.R#L160         res[[paste0(rbp, "_density_fc")] ...
R/simulation.R#L161         res[[paste0(rbp, "_occupancy_fc" ...
R/simulation.R#L163         # Edge case: this RBP is the onl ...
R/simulation.R#L166         res[[paste0(rbp, "_occupancy_fc" ...
R/simulation.R#L196 simulateGrid <- function(sequence, rbp_m ...
R/simulation.R#L201     stop("sequence must be a single char ...
R/simulation.R#L235     res <- simulateBinding(sequence, rbp ...
R/simulation.R#L250     results_list <- parallel::mclapply(s ...
R/simulation.R#L254     parallel::clusterExport(cl, varlist  ...
R/simulation.R#L255                                          ...
R/simulation.R#L256                                          ...
R/simulation.R#L289 #' fasta_file <- system.file("extdata",  ...
R/simulation.R#L296 simulateBindingF <- function(fasta_file, ...
R/simulation.R#L334     results_list <- parallel::mclapply(s ...
R/simulation.R#L341     parallel::clusterExport(cl, varlist  ...
R/simulation.R#L357 #' Simulates binding for all sequences i ...
R/simulation.R#L374 simulateGridF <- function(fasta_file, rb ...
R/simulation.R#L413     results_list <- parallel::mclapply(s ...
R/utils.R#L57 #' Generates a vector of all k-mers from ...
R/visualization.R#L8 #' @param metric Type of metric: "occupa ...
R/visualization.R#L13 #' @param protein_conc Optional named nu ...
R/visualization.R#L24 plotBinding <- function(results, rbp, tr ...
R/visualization.R#L25                          ylim = NULL, xl ...
R/visualization.R#L63     group_col <- if ("transcript" %in% n ...
R/visualization.R#L123     melted <- data.table::melt(data, id. ...
R/visualization.R#L153     p <- p + ggplot2::scale_x_continuous ...
R/visualization.R#L154       ggplot2::theme(axis.text.x = ggplo ...
R/visualization.R#L168       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L188 #' @param metric Type of metric: "occupa ...
R/visualization.R#L204                          metric = c("occ ...
R/visualization.R#L215     meta <- c("pos", "nt", "transcript", ...
R/visualization.R#L237   group_col <- if ("transcript" %in% nam ...
R/visualization.R#L273     melted <- data.table::melt(data, id. ...
R/visualization.R#L279   title_suffix <- if (!is.null(window) & ...
R/visualization.R#L284     ggplot2::labs(title = paste0("Bindin ...
R/visualization.R#L290     p <- p + ggplot2::scale_x_continuous ...
R/visualization.R#L291       ggplot2::theme(axis.text.x = ggplo ...
R/visualization.R#L295       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L300       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L324 plotGrid <- function(results, rbp1, rbp2 ...
R/visualization.R#L391           value = val, rbp1_conc = rbp1_ ...
R/visualization.R#L398     ggplot2::geom_tile(ggplot2::aes(widt ...
R/visualization.R#L401                                  name =  ...
R/visualization.R#L403                                  name =  ...
R/visualization.R#L406       subtitle = paste("ROI:", roi_range ...
R/visualization.R#L428 #' @param protein_conc Named numeric vec ...
R/visualization.R#L442                         metric = c("occu ...
R/visualization.R#L498     stop("Required columns not found. Ne ...
R/visualization.R#L537     r_x <- if (!is.na(val_x) && val_x >  ...
R/visualization.R#L538     r_y <- if (!is.na(val_y) && val_y >  ...
R/visualization.R#L571     seq_dt <- unique(results[pos >= roi_ ...
R/visualization.R#L632   if (!is.null(rna_conc)) subtitle_parts ...
R/visualization.R#L642   p <- ggplot2::ggplot(all_poly, ggplot2 ...
R/visualization.R#L644     # Color scale: include legend color  ...
R/visualization.R#L657                        fontface = "bold" ...
R/visualization.R#L662     # coord_fixed maintains aspect ratio ...
R/visualization.R#L663     ggplot2::coord_fixed(ratio = 1, xlim ...
R/visualization.R#L665       title = paste("Competitive Binding ...
R/visualization.R#L701                          bins = 50, colo ...
vignettes/RBPBind-intro.Rmd#L26 **RBPBind** simulates competitive bindin ...
vignettes/RBPBind-intro.Rmd#L27 to RNA sequences using an equilibrium bi ...
vignettes/RBPBind-intro.Rmd#L39 based on equilibrium binding kinetics. T ...
vignettes/RBPBind-intro.Rmd#L41 1. **Simultaneous competition**: All RBP ...
vignettes/RBPBind-intro.Rmd#L43 2. **Independent binding sites**: Each R ...
vignettes/RBPBind-intro.Rmd#L49 For an RNA sequence of length $l$ intera ...
vignettes/RBPBind-intro.Rmd#L65 From the equilibrium concentrations, bin ...
vignettes/RBPBind-intro.Rmd#L67 obtained by averaging overlapping $p_{si ...
vignettes/RBPBind-intro.Rmd#L69 For RBP enrichment analysis, fold-change ...
vignettes/RBPBind-intro.Rmd#L77 exist more than once in the RNA sequence ...
vignettes/RBPBind-intro.Rmd#L78 of a binding site $[R_{0,e}]$ is calcula ...
vignettes/RBPBind-intro.Rmd#L83 For a detailed description of the mathem ...
vignettes/RBPBind-intro.Rmd#L87 > *Inherent Specificity and Mutational S ...
vignettes/RBPBind-intro.Rmd#L102 RBP affinity models are loaded from CSV  ...
vignettes/RBPBind-intro.Rmd#L103 (enrichment or affinity values). The CSV ...
vignettes/RBPBind-intro.Rmd#L125 poly-U motif (UUUUU) with highest affini ...
vignettes/RBPBind-intro.Rmd#L141 For binding simulation, each RBP may hav ...
vignettes/RBPBind-intro.Rmd#L173 viewModel(rbp_models, rbp = c("HH", "LL" ...
vignettes/RBPBind-intro.Rmd#L178 Given the initial concentrations of RBPs ...
vignettes/RBPBind-intro.Rmd#L179 (or dissociation constants) per motif pe ...
vignettes/RBPBind-intro.Rmd#L210 Users can provide their own sequence or  ...
vignettes/RBPBind-intro.Rmd#L219 seq <- "UAGCGGUGCGAUUGGCCCGUGGACCGCGUUUU ...
vignettes/RBPBind-intro.Rmd#L251 Each metric calculated using `simulateBi ...
vignettes/RBPBind-intro.Rmd#L258 > **Note:** The visualizations below sho ...
vignettes/RBPBind-intro.Rmd#L269 ```{r scenario1-binding-window, fig.cap= ...
vignettes/RBPBind-intro.Rmd#L285 Simulation results can be exported using ...
vignettes/RBPBind-intro.Rmd#L380   protein_conc_grid = list(HH = c(0, 10, ...
vignettes/RBPBind-intro.Rmd#L396 Grid sweep results can also be exported  ...
vignettes/RBPBind-intro.Rmd#L401 from bioMart), RBPBind provides function ...
vignettes/RBPBind-intro.Rmd#L402 binding simulation is performed on a seq ...
vignettes/RBPBind-intro.Rmd#L420 # Scenario 4: RBPs Binding to Multiple T ...
vignettes/RBPBind-intro.Rmd#L422 RBPBind also supports concentration grid ...
Consider multiples of 4 spaces for line indents; 958 lines (40%) are not.
First few lines:
R/data_loading.R#L21   if (!file.exists(file)) { ...
R/data_loading.R#L23   } ...
R/data_loading.R#L24    ...
R/data_loading.R#L25   dt <- data.table::fread(file) ...
R/data_loading.R#L26    ...
R/data_loading.R#L27   # Find motif column (case-insensitive) ...
R/data_loading.R#L28   motif_col <- grep("^motif$", names(dt) ...
R/data_loading.R#L29   if (length(motif_col) == 0) { ...
R/data_loading.R#L31   } ...
R/data_loading.R#L32    ...
R/data_loading.R#L33   # Get RBP columns (everything except m ...
R/data_loading.R#L34   all_rbps <- setdiff(names(dt), motif_c ...
R/data_loading.R#L35    ...
R/data_loading.R#L36   if (length(all_rbps) == 0) { ...
R/data_loading.R#L38   } ...
R/data_loading.R#L39    ...
R/data_loading.R#L40   # Filter to requested RBPs ...
R/data_loading.R#L41   if (!is.null(rbp)) { ...
R/data_loading.R#L44       stop("RBPs not found in file: ", p ...
R/data_loading.R#L47   } ...
R/data_loading.R#L48    ...
R/data_loading.R#L49   # Filter by k-mer length ...
R/data_loading.R#L50   if (!is.null(k)) { ...
R/data_loading.R#L53       warning("No k-mers of length ", k, ...
R/data_loading.R#L54       return(list()) ...
R/data_loading.R#L56   } ...
R/data_loading.R#L57    ...
R/data_loading.R#L58   # Create named list of models ...
R/data_loading.R#L59   models <- lapply(all_rbps, function(rb ...
R/data_loading.R#L61       motif = dt[[motif_col]], ...
R/data_loading.R#L62       score = dt[[rbp_name]] ...
R/data_loading.R#L64   }) ...
R/data_loading.R#L65   names(models) <- all_rbps ...
R/data_loading.R#L66    ...
R/data_loading.R#L67   return(models) ...
R/data_loading.R#L90    ...
R/data_loading.R#L91   get_value <- function(vec, name, defau ...
R/data_loading.R#L93       return(vec) ...
R/data_loading.R#L96       return(vec[name]) ...
R/data_loading.R#L99   } ...
R/data_loading.R#L100    ...
R/data_loading.R#L101   result <- list() ...
R/data_loading.R#L102   for (name in names(models)) { ...
R/data_loading.R#L106       stop("Model ", name, " must have ' ...
R/data_loading.R#L115       dt[, Ka := current_max] ...
R/data_loading.R#L117       dt[, Ka := featureScale(score, MAX ...
R/data_loading.R#L124   } ...
R/data_loading.R#L125    ...
R/data_loading.R#L126   return(result) ...
R/equilibrium.R#L19   # Input validation ...
R/equilibrium.R#L20   if (length(protein_totals) != length(K ...
R/equilibrium.R#L22   } ...
R/equilibrium.R#L23   if (RNA_total < 0) stop("RNA_total mus ...
R/equilibrium.R#L24   if (any(protein_totals < 0)) stop("pro ...
R/equilibrium.R#L25   if (any(Kds <= 0)) stop("Kds must be p ...
R/equilibrium.R#L26    ...
R/equilibrium.R#L27   # If RNA is 0, free RNA is 0 ...
R/equilibrium.R#L28   if (RNA_total == 0) return(0) ...
R/equilibrium.R#L29    ...
R/equilibrium.R#L30   # Define the objective function: f(Fre ...
R/equilibrium.R#L31   # X = FreeRNA ...
R/equilibrium.R#L32   # Equation: X - RNA_total + sum( (P_to ...
R/equilibrium.R#L33   obj_func <- function(X) { ...
R/equilibrium.R#L36   } ...
R/equilibrium.R#L37    ...
R/equilibrium.R#L38   # Root finding ...
R/equilibrium.R#L39   # Lower bound: 0 ...
R/equilibrium.R#L40   # Upper bound: RNA_total (Free RNA can ...
R/equilibrium.R#L41   # Check boundaries ...
R/equilibrium.R#L42   f_lower <- obj_func(0) # -RNA_total <  ...
R/equilibrium.R#L43   f_upper <- obj_func(RNA_total) # sum(. ...
R/equilibrium.R#L44    ...
R/equilibrium.R#L45   if (f_lower == 0) return(0) ...
R/equilibrium.R#L46   if (f_upper == 0) return(RNA_total) ...
R/equilibrium.R#L47    ...
R/equilibrium.R#L48   # Use uniroot ...
R/equilibrium.R#L49   result <- stats::uniroot(obj_func, int ...
R/equilibrium.R#L50   return(result$root) ...
R/equilibrium.R#L66   return((protein_totals * free_RNA) / ( ...
R/export.R#L19   format <- match.arg(format) ...
R/export.R#L20    ...
R/export.R#L21   if (format == "json") { ...
R/export.R#L25       exclude <- c("pos", "nt", group_co ...
R/export.R#L26       rbp_cols <- setdiff(names(results) ...
R/export.R#L27       aggregated <- results[, lapply(.SD ...
R/export.R#L28        ...
R/export.R#L29       if (include_sequence && "nt" %in%  ...
R/export.R#L32       } ...
R/export.R#L33        ...
R/export.R#L34       lens <- results[, .(length = .N),  ...
R/export.R#L35       aggregated <- merge(aggregated, le ...
R/export.R#L36       setnames(aggregated, group_col, "n ...
R/export.R#L37       jsonlite::stream_out(aggregated, f ...
R/export.R#L39       jsonlite::write_json(results, outp ...
R/export.R#L41   } else if (format == "csv") { ...
R/export.R#L43   } ...
R/export.R#L61   # Need pos, transcript/seq_name ...
R/export.R#L62   group_col <- if ("transcript" %in% nam ...
R/export.R#L63   if (is.null(group_col)) stop("Results  ...
R/export.R#L64    ...
R/export.R#L65   if (!rbp %in% names(results)) stop("RB ...
R/export.R#L66    ...
R/export.R#L67   # Filter ...
R/export.R#L68   bed_dt <- results[get(rbp) > threshold ...
R/export.R#L69   if (nrow(bed_dt) == 0) { ...
R/export.R#L73   } ...
R/export.R#L74    ...
R/export.R#L75   # Coordinate conversion: BED is 0-inde ...
R/export.R#L76   # pos is 1-indexed. ...
R/export.R#L77   # start = pos - 1 ...
R/export.R#L78   # end = pos ...
R/export.R#L79    ...
R/export.R#L80   # Naive export: one line per position? ...
R/export.R#L81   # Better to merge adjacent ...
R/export.R#L82   # Use GenomicRanges logic if available ...
R/export.R#L83    ...
R/export.R#L84   # Sort ...
R/export.R#L85   setkeyv(bed_dt, c(group_col, "pos")) ...
R/export.R#L86    ...
R/export.R#L87   # Identify jumps ...
R/export.R#L88   bed_dt[, g := cumsum(c(0, diff(pos) >  ...
R/export.R#L89    ...
R/export.R#L90   # Aggregate ...
R/export.R#L91   regions <- bed_dt[, .(chrom = first(ge ...
R/export.R#L96    ...
R/export.R#L97   # Select BED columns: chrom, start, en ...
R/export.R#L98   out <- regions[, .(chrom, start, end,  ...
R/export.R#L99    ...
R/export.R#L100   data.table::fwrite(out, output_file, s ...
R/export.R#L118   if (!file.exists(input_file)) stop("Fi ...
R/export.R#L119    ...
R/export.R#L120   # Try JSONL format first (stream_in) ...
R/export.R#L121   tryCatch({ ...
R/export.R#L130       # Check if any columns are lists ( ...
R/export.R#L131       list_cols <- vapply(raw, is.list,  ...
R/export.R#L132        ...
R/export.R#L133       if (any(list_cols)) { ...
R/export.R#L141           row <- raw[i, ] ...
R/export.R#L142           n_pos <- length(row[[rbp_cols[ ...
R/export.R#L143            ...
R/export.R#L144           expanded <- data.table::data.t ...
R/export.R#L145            ...
R/export.R#L146           # Add ID columns ...
R/export.R#L147           for (col in id_cols) { ...
R/export.R#L149           } ...
R/export.R#L150            ...
R/export.R#L151           # Add RBP columns ...
R/export.R#L152           for (col in rbp_cols) { ...
R/export.R#L154           } ...
R/export.R#L155            ...
R/export.R#L156           expanded ...
R/export.R#L160       } else { ...
R/export.R#L162       } ...
R/export.R#L167   }, error = function(e) { ...
R/export.R#L171   }) ...
R/export.R#L193   if (!requireNamespace("SummarizedExper ...
R/export.R#L195   } ...
R/export.R#L196    ...
R/export.R#L197   # Identify RBP columns (those without  ...
R/export.R#L198   all_cols <- names(results) ...
R/export.R#L199   density_cols <- grep("_density$", all_ ...
R/export.R#L200   rbp_names <- gsub("_density$", "", den ...
R/export.R#L201    ...
R/export.R#L202   if (length(rbp_names) == 0) { ...
R/export.R#L204   } ...
R/export.R#L205    ...
R/export.R#L206   # Build rowData ...
R/export.R#L207   row_cols <- intersect(c("pos", "nt", " ...
R/export.R#L208   if (length(row_cols) == 0) { ...
R/export.R#L210   } ...
R/export.R#L211    ...
R/export.R#L212   row_data <- S4Vectors::DataFrame(resul ...
R/export.R#L213    ...
R/export.R#L214   n_pos <- nrow(results) ...
R/export.R#L215   n_rbp <- length(rbp_names) ...
R/export.R#L216    ...
R/export.R#L217   # Build assay matrices ...
R/export.R#L218   # Each assay is n_pos rows × n_rbp col ...
R/export.R#L219   make_matrix <- function(suffix) { ...
R/export.R#L223       warning("Missing columns for assay ...
R/export.R#L224       return(NULL) ...
R/export.R#L229   } ...
R/export.R#L230    ...
R/export.R#L231   assays <- list( ...
R/export.R#L236   ) ...
R/export.R#L237    ...
R/export.R#L238   # Remove NULL assays ...
R/export.R#L239   assays <- assays[!vapply(assays, is.nu ...
R/export.R#L240    ...
R/export.R#L241   if (length(assays) == 0) { ...
R/export.R#L243   } ...
R/export.R#L244    ...
R/export.R#L245   # Build colData (RBP metadata) ...
R/export.R#L246   col_data <- S4Vectors::DataFrame( ...
R/export.R#L249   ) ...
R/export.R#L250    ...
R/export.R#L251   # Add Kd ranges if rbp_models provided ...
R/export.R#L252   if (!is.null(rbp_models)) { ...
R/export.R#L254       if (r %in% names(rbp_models) && "K ...
R/export.R#L256       } else { ...
R/export.R#L258       } ...
R/export.R#L261       if (r %in% names(rbp_models) && "K ...
R/export.R#L263       } else { ...
R/export.R#L265       } ...
R/export.R#L269   } ...
R/export.R#L270    ...
R/export.R#L271   # Create SummarizedExperiment ...
R/export.R#L272   se <- SummarizedExperiment::Summarized ...
R/export.R#L276   ) ...
R/export.R#L277    ...
R/export.R#L278   return(se) ...
R/globals.R#L5   # data.table special symbols ...
R/globals.R#L6   ".", ".N", ".SD", ":=", ...
R/globals.R#L7    ...
R/globals.R#L8   # Column names used in data.table expr ...
R/globals.R#L9   "..cols", "..row_cols", ...
R/globals.R#L10   "bg", "chrom", "cluster", "end", "firs ...
R/globals.R#L11   "height", "is_peak", "Ka", "Kd", "labe ...
R/globals.R#L12   "name", "nt", "pos", "RBP", "rleid", " ...
R/globals.R#L13   "start", "value", "Value", "width", "x ...
R/globals.R#L14    ...
R/globals.R#L15   # data.table functions used without na ...
R/globals.R#L16   "copy", "setkeyv", "setnames" ...
R/peaks.R#L24                        method = c("compe ...
R/peaks.R#L25                        threshold = 2.0,  ...
R/peaks.R#L26    ...
R/peaks.R#L27   method <- match.arg(method) ...
R/peaks.R#L28    ...
R/peaks.R#L29   if (!rbp_primary %in% names(results))  ...
R/peaks.R#L30    ...
R/peaks.R#L31   group_col <- if ("transcript" %in% nam ...
R/peaks.R#L32   if (is.null(group_col)) stop("No trans ...
R/peaks.R#L33    ...
R/peaks.R#L34   # Copy data to avoid modification ...
R/peaks.R#L35   dt <- copy(results) ...
R/peaks.R#L36    ...
R/peaks.R#L37   # Calculate Score ...
R/peaks.R#L38   if (method == "competitive") { ...
R/peaks.R#L45   } else if (method == "local") { ...
R/peaks.R#L55   } else if (method == "global") { ...
R/peaks.R#L59   } ...
R/peaks.R#L60    ...
R/peaks.R#L61   # Identify peaks ...
R/peaks.R#L62   dt[, is_peak := score > threshold] ...
R/peaks.R#L63    ...
R/peaks.R#L64   # Run-length encoding to merge ...
R/peaks.R#L65   # data.table way: grouping by consecut ...
R/peaks.R#L66   dt[, cluster := rleid(is_peak), by = g ...
R/peaks.R#L67    ...
R/peaks.R#L68   peaks <- dt[is_peak == TRUE, .( ...
R/peaks.R#L74   ), by = c(group_col, "cluster")] ...
R/peaks.R#L75    ...
R/peaks.R#L76   # Filter width ...
R/peaks.R#L77   peaks <- peaks[length >= min_width] ...
R/peaks.R#L78    ...
R/peaks.R#L79   # Format output ...
R/peaks.R#L80   # BED-like: start is 0-based? results  ...
R/peaks.R#L81   # Let's keep 1-based for now or follow ...
R/peaks.R#L82   # The user API spec usually implies 1- ...
R/peaks.R#L83    ...
R/peaks.R#L84   peaks[, cluster := NULL] ...
R/peaks.R#L85    ...
R/peaks.R#L86   return(peaks) ...
R/simulation.R#L24    ...
R/simulation.R#L26   if (!all(names(protein_concs) %in% nam ...
R/simulation.R#L28   } ...
R/simulation.R#L29   rbp_names <- names(protein_concs) ...
R/simulation.R#L30   n_rbps <- length(rbp_names) ...
R/simulation.R#L31    ...
R/simulation.R#L33   kmers <- extractKmers(sequence, k) ...
R/simulation.R#L34   if (length(kmers) == 0) { ...
R/simulation.R#L37   } ...
R/simulation.R#L38    ...
R/simulation.R#L39   unique_kmers <- countKmers(kmers) ...
R/simulation.R#L40   if (nrow(unique_kmers) == 0) { ...
R/simulation.R#L41       warning("Unique k-mers count is 0" ...
R/simulation.R#L42       return(NULL) ...
R/simulation.R#L43   } ...
R/simulation.R#L44    ...
R/simulation.R#L45   binding_params <- unique_kmers ...
R/simulation.R#L46    ...
R/simulation.R#L47   for (rbp in rbp_names) { ...
R/simulation.R#L50       stop("Model for ", rbp, " must be  ...
R/simulation.R#L55       missing <- head(binding_params$mot ...
R/simulation.R#L56       warning("Some motifs in sequence n ...
R/simulation.R#L57       kds <- rep(Inf, nrow(binding_param ...
R/simulation.R#L58       kds[!is.na(match_idx)] <- model$Kd ...
R/simulation.R#L60       kds <- model$Kd[match_idx] ...
R/simulation.R#L64   } ...
R/simulation.R#L65    ...
R/simulation.R#L66   binding_params$FreeRNA <- 0.0 ...
R/simulation.R#L67   for (rbp in rbp_names) { ...
R/simulation.R#L69   } ...
R/simulation.R#L70    ...
R/simulation.R#L71   p0_vec <- protein_concs[rbp_names] ...
R/simulation.R#L72   n_unique <- nrow(binding_params) ...
R/simulation.R#L73   res_Req <- numeric(n_unique) ...
R/simulation.R#L74   res_Bound <- matrix(0, nrow = n_unique ...
R/simulation.R#L75   colnames(res_Bound) <- rbp_names ...
R/simulation.R#L76    ...
R/simulation.R#L77   for (i in seq_len(n_unique)) { ...
R/simulation.R#L81       current_kds[j] <- binding_params[[ ...
R/simulation.R#L88       occ_vec <- bound_eq / eR0 ...
R/simulation.R#L90       occ_vec <- rep(0, n_rbps) ...
R/simulation.R#L93   } ...
R/simulation.R#L94    ...
R/simulation.R#L95   binding_res <- cbind(binding_params, r ...
R/simulation.R#L96   kmer_indices <- match(kmers, binding_r ...
R/simulation.R#L97    ...
R/simulation.R#L98   L <- nchar(sequence) ...
R/simulation.R#L99   W <- length(kmers) ...
R/simulation.R#L100   window_occupancy <- res_Bound[kmer_ind ...
R/simulation.R#L101    ...
R/simulation.R#L102   # Use cumsum trick for efficient posit ...
R/simulation.R#L103   diff_mat <- matrix(0, nrow = L + 1, nc ...
R/simulation.R#L104   diff_mat[seq_len(W), ] <- diff_mat[seq ...
R/simulation.R#L105   diff_mat[(k + 1):(L + 1), ] <- diff_ma ...
R/simulation.R#L106   pos_sums <- apply(diff_mat, 2, cumsum) ...
R/simulation.R#L107    ...
R/simulation.R#L108   count_diff <- numeric(L + 1) ...
R/simulation.R#L109   count_diff[seq_len(W)] <- count_diff[s ...
R/simulation.R#L110   count_diff[(k + 1):(L + 1)] <- count_d ...
R/simulation.R#L111   pos_counts <- cumsum(count_diff)[seq_l ...
R/simulation.R#L112   pos_counts[pos_counts == 0] <- 1 ...
R/simulation.R#L113    ...
R/simulation.R#L114   final_mat <- pos_sums / pos_counts ...
R/simulation.R#L115   seq_chars <- strsplit(sequence, "")[[1 ...
R/simulation.R#L116    ...
R/simulation.R#L117   res <- data.table::data.table( ...
R/simulation.R#L120   ) ...
R/simulation.R#L121    ...
R/simulation.R#L122   res <- cbind(res, data.table::as.data. ...
R/simulation.R#L123   colnames(res)[3:ncol(res)] <- rbp_name ...
R/simulation.R#L124    ...
R/simulation.R#L125   # Add density column for each RBP ...
R/simulation.R#L126   for (rbp in rbp_names) { ...
R/simulation.R#L130   } ...
R/simulation.R#L131    ...
R/simulation.R#L132   # Calculate FC based on number of acti ...
R/simulation.R#L133   # Active RBPs are determined by protei ...
R/simulation.R#L134   active_rbps <- names(protein_concs)[pr ...
R/simulation.R#L135   n_active <- length(active_rbps) ...
R/simulation.R#L136   L <- nrow(res)  # sequence length ...
R/simulation.R#L137    ...
R/simulation.R#L138   for (rbp in rbp_names) { ...
R/simulation.R#L143       # Case 1: Single RBP - fold change ...
R/simulation.R#L144       # fc = density / (1/L) = density * ...
R/simulation.R#L145       # For occupancy: fc = occupancy /  ...
R/simulation.R#L146       mean_occ <- mean(occ_col, na.rm =  ...
R/simulation.R#L147       res[[paste0(rbp, "_density_fc")]]  ...
R/simulation.R#L148       res[[paste0(rbp, "_occupancy_fc")] ...
R/simulation.R#L150       # Case 2: Multiple RBPs - ratio vs ...
R/simulation.R#L151       # Only consider other ACTIVE RBPs ...
R/simulation.R#L152       other_active <- setdiff(active_rbp ...
R/simulation.R#L153        ...
R/simulation.R#L154       if (length(other_active) > 0) { ...
R/simulation.R#L162       } else { ...
R/simulation.R#L167       } ...
R/simulation.R#L169   } ...
R/simulation.R#L170    ...
R/simulation.R#L171   return(res) ...
R/simulation.R#L197                           k = 5, paralle ...
R/simulation.R#L198    ...
R/simulation.R#L199   # Validate: sequence must be a single  ...
R/simulation.R#L200   if (!is.character(sequence) || length( ...
R/simulation.R#L202   } ...
R/simulation.R#L203    ...
R/simulation.R#L204   # Expand protein concentration grid ...
R/simulation.R#L205   prot_grid <- do.call(expand.grid, prot ...
R/simulation.R#L206    ...
R/simulation.R#L207   # Create full grid: RNA conc × protein ...
R/simulation.R#L208   grid_args <- list( ...
R/simulation.R#L211   ) ...
R/simulation.R#L212   full_grid <- do.call(expand.grid, grid ...
R/simulation.R#L213   n_jobs <- nrow(full_grid) ...
R/simulation.R#L214    ...
R/simulation.R#L215   # Parallel setup ...
R/simulation.R#L216   if (parallel) { ...
R/simulation.R#L219   } else { ...
R/simulation.R#L221   } ...
R/simulation.R#L222    ...
R/simulation.R#L223   # Job function for one grid point ...
R/simulation.R#L224   run_job <- function(i) { ...
R/simulation.R#L242       res[[paste0("Conc_", p)]] <- prot_ ...
R/simulation.R#L246   } ...
R/simulation.R#L247    ...
R/simulation.R#L248   # Execute ...
R/simulation.R#L249   if (n_cores > 1 && .Platform$OS.type ! ...
R/simulation.R#L251   } else if (n_cores > 1 && .Platform$OS ...
R/simulation.R#L255                                          ...
R/simulation.R#L256                                          ...
R/simulation.R#L260   } else { ...
R/simulation.R#L262   } ...
R/simulation.R#L263    ...
R/simulation.R#L264   # Combine results ...
R/simulation.R#L265   final_dt <- data.table::rbindlist(resu ...
R/simulation.R#L266   return(final_dt) ...
R/simulation.R#L297                                k = 5, pa ...
R/simulation.R#L298    ...
R/simulation.R#L299   if (!file.exists(fasta_file)) stop("FA ...
R/simulation.R#L300    ...
R/simulation.R#L301   seqs_dna <- Biostrings::readDNAStringS ...
R/simulation.R#L302   n_seqs <- length(seqs_dna) ...
R/simulation.R#L303    ...
R/simulation.R#L304   seq_names <- names(seqs_dna) ...
R/simulation.R#L305   if (is.null(seq_names) || any(seq_name ...
R/simulation.R#L308   } ...
R/simulation.R#L309    ...
R/simulation.R#L310   get_seq_str <- function(i) { ...
R/simulation.R#L313   } ...
R/simulation.R#L314    ...
R/simulation.R#L315   if (parallel) { ...
R/simulation.R#L318   } else { ...
R/simulation.R#L320   } ...
R/simulation.R#L321    ...
R/simulation.R#L322   run_seq <- function(i) { ...
R/simulation.R#L326       warning("Simulation returned NULL  ...
R/simulation.R#L327       return(NULL) ...
R/simulation.R#L331   } ...
R/simulation.R#L332    ...
R/simulation.R#L333   if (n_cores > 1 && .Platform$OS.type ! ...
R/simulation.R#L335   } else if (n_cores > 1 && .Platform$OS ...
R/simulation.R#L338       requireNamespace("data.table", qui ...
R/simulation.R#L339       requireNamespace("Biostrings", qui ...
R/simulation.R#L342                                          ...
R/simulation.R#L343                                          ...
R/simulation.R#L347   } else { ...
R/simulation.R#L349   } ...
R/simulation.R#L350    ...
R/simulation.R#L351   data.table::rbindlist(results_list) ...
R/simulation.R#L376    ...
R/simulation.R#L377   if (!file.exists(fasta_file)) stop("FA ...
R/simulation.R#L378    ...
R/simulation.R#L379   seqs_dna <- Biostrings::readDNAStringS ...
R/simulation.R#L380   n_seqs <- length(seqs_dna) ...
R/simulation.R#L381    ...
R/simulation.R#L382   seq_names <- names(seqs_dna) ...
R/simulation.R#L383   if (is.null(seq_names) || any(seq_name ...
R/simulation.R#L386   } ...
R/simulation.R#L387    ...
R/simulation.R#L388   message("Running grid simulation on ", ...
R/simulation.R#L389    ...
R/simulation.R#L390   # Parallelize at sequence level, not i ...
R/simulation.R#L391   # to avoid nested parallelization ...
R/simulation.R#L392   if (parallel) { ...
R/simulation.R#L395   } else { ...
R/simulation.R#L397   } ...
R/simulation.R#L398    ...
R/simulation.R#L399   run_seq_grid <- function(i) { ...
R/simulation.R#L405                          k = k, parallel ...
R/simulation.R#L407       res$transcript <- seq_names[i] ...
R/simulation.R#L410   } ...
R/simulation.R#L411    ...
R/simulation.R#L412   if (n_cores > 1 && .Platform$OS.type ! ...
R/simulation.R#L414   } else { ...
R/simulation.R#L416   } ...
R/simulation.R#L417    ...
R/simulation.R#L418   data.table::rbindlist(results_list) ...
R/utils.R#L13   if (MAX <= MIN) { ...
R/utils.R#L15   } ...
R/utils.R#L16   X_min <- min(X, na.rm = TRUE) ...
R/utils.R#L17   X_max <- max(X, na.rm = TRUE) ...
R/utils.R#L18    ...
R/utils.R#L19   if (X_max == X_min) return(rep(MIN, le ...
R/utils.R#L20    ...
R/utils.R#L21   return(MIN + ((X - X_min) * (MAX - MIN ...
R/utils.R#L39   if (abs(sum(c(A, G, C, U)) - 1) > 1e-9 ...
R/utils.R#L41   } ...
R/utils.R#L42    ...
R/utils.R#L43   nts <- c("A", "G", "C", "U") ...
R/utils.R#L44   probs <- c(A, G, C, U) ...
R/utils.R#L45    ...
R/utils.R#L46   seq_vec <- sample(nts, size = L, repla ...
R/utils.R#L47   return(paste(seq_vec, collapse = "")) ...
R/utils.R#L66   if (nchar(sequence) < k) { ...
R/utils.R#L68   } ...
R/utils.R#L69   n <- nchar(sequence) ...
R/utils.R#L70   starts <- 1:(n - k + 1) ...
R/utils.R#L71   ends <- k:n ...
R/utils.R#L72   substring(sequence, starts, ends) ...
R/utils.R#L87   dt <- data.table::data.table(motif = k ...
R/utils.R#L88   dt[, .(count = .N), by = motif] ...
R/visualization.R#L25                          ylim = NULL, xl ...
R/visualization.R#L26                          rna_conc = NULL ...
R/visualization.R#L27   if (!requireNamespace("ggplot2", quiet ...
R/visualization.R#L29   } ...
R/visualization.R#L30    ...
R/visualization.R#L31   metric <- match.arg(metric) ...
R/visualization.R#L32   xaxis_type <- match.arg(xaxis_type) ...
R/visualization.R#L33    ...
R/visualization.R#L34   # Determine which columns to use based ...
R/visualization.R#L35   if (metric == "occupancy") { ...
R/visualization.R#L38   } else if (metric == "density") { ...
R/visualization.R#L41   } else if (metric == "density_fc") { ...
R/visualization.R#L44   } else { ...
R/visualization.R#L47   } ...
R/visualization.R#L48    ...
R/visualization.R#L49   # Build column names to extract ...
R/visualization.R#L50   value_cols <- paste0(rbp, col_suffix) ...
R/visualization.R#L51    ...
R/visualization.R#L52   # Check columns exist ...
R/visualization.R#L53   missing_cols <- setdiff(value_cols, na ...
R/visualization.R#L54   if (length(missing_cols) > 0) { ...
R/visualization.R#L56          ". Available: ", paste(names(re ...
R/visualization.R#L57   } ...
R/visualization.R#L58    ...
R/visualization.R#L59   data <- copy(results) ...
R/visualization.R#L60    ...
R/visualization.R#L61   # Filters ...
R/visualization.R#L62   if (!is.null(transcript)) { ...
R/visualization.R#L65        data <- data[get(group_col) == tr ...
R/visualization.R#L67   } ...
R/visualization.R#L68    ...
R/visualization.R#L69   if (!is.null(rna_conc)) { ...
R/visualization.R#L70      target_rna <- rna_conc ...
R/visualization.R#L71      if ("rna_conc" %in% names(data)) { ...
R/visualization.R#L73      } ...
R/visualization.R#L74   } ...
R/visualization.R#L75    ...
R/visualization.R#L76   if (!is.null(protein_conc)) { ...
R/visualization.R#L77      for (p_name in names(protein_conc)) ...
R/visualization.R#L81            data <- data[get(col) == val] ...
R/visualization.R#L83      } ...
R/visualization.R#L84   } ...
R/visualization.R#L85    ...
R/visualization.R#L86   if (!is.null(xlim)) { ...
R/visualization.R#L88   } ...
R/visualization.R#L89    ...
R/visualization.R#L90   # Handle window: create K-mer averaged ...
R/visualization.R#L91   if (!is.null(window) && window > 1 &&  ...
R/visualization.R#L101       r <- rbp[i] ...
R/visualization.R#L102       col <- value_cols[i] ...
R/visualization.R#L103       for (j in seq_along(valid_starts)) ...
R/visualization.R#L110           pos = start_pos, ...
R/visualization.R#L111           RBP = r, ...
R/visualization.R#L112           Value = avg_val, ...
R/visualization.R#L113           kmer = kmer ...
R/visualization.R#L115       } ...
R/visualization.R#L121   } else { ...
R/visualization.R#L124                                variable. ...
R/visualization.R#L127       melted[, RBP := gsub(col_suffix, " ...
R/visualization.R#L130   } ...
R/visualization.R#L131    ...
R/visualization.R#L132   title_text <- "Binding Profile" ...
R/visualization.R#L133   if (!is.null(window) && window > 1) { ...
R/visualization.R#L135   } ...
R/visualization.R#L136    ...
R/visualization.R#L137   p <- ggplot2::ggplot(melted, ggplot2:: ...
R/visualization.R#L142       axis.text = ggplot2::element_text( ...
R/visualization.R#L143       axis.title = ggplot2::element_text ...
R/visualization.R#L144       legend.text = ggplot2::element_tex ...
R/visualization.R#L146    ...
R/visualization.R#L147   if (!is.null(ylim)) { ...
R/visualization.R#L149   } ...
R/visualization.R#L150    ...
R/visualization.R#L151   # Handle X-axis labels ...
R/visualization.R#L152   if (!is.null(window) && window > 1 &&  ...
R/visualization.R#L154       ggplot2::theme(axis.text.x = ggplo ...
R/visualization.R#L155   } else if ("nt" %in% names(data)) { ...
R/visualization.R#L160       r <- range(labels_dt$pos) ...
R/visualization.R#L161       start_10 <- ceiling(r[1]/10)*10 ...
R/visualization.R#L162       end_10 <- floor(r[2]/10)*10 ...
R/visualization.R#L163       if (start_10 <= end_10) { ...
R/visualization.R#L166       } ...
R/visualization.R#L168       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L170       brks <- labels_dt$pos ...
R/visualization.R#L171       lbls <- labels_dt$nt ...
R/visualization.R#L172       tens_idx <- which(brks %% 10 == 0) ...
R/visualization.R#L173       lbls[tens_idx] <- paste0(lbls[tens ...
R/visualization.R#L174       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L176   } ...
R/visualization.R#L178   return(p) ...
R/visualization.R#L203                          xaxis_type = c( ...
R/visualization.R#L204                          metric = c("occ ...
R/visualization.R#L205                          window = NULL,  ...
R/visualization.R#L206   if (!requireNamespace("ggplot2", quiet ...
R/visualization.R#L208   } ...
R/visualization.R#L209    ...
R/visualization.R#L210   xaxis_type <- match.arg(xaxis_type) ...
R/visualization.R#L211   metric <- match.arg(metric) ...
R/visualization.R#L212    ...
R/visualization.R#L213   # Infer RBPs if not provided ...
R/visualization.R#L214   if (is.null(rbps)) { ...
R/visualization.R#L218   } ...
R/visualization.R#L219    ...
R/visualization.R#L220   # Determine columns based on metric ...
R/visualization.R#L221   if (metric == "occupancy") { ...
R/visualization.R#L224   } else if (metric == "density") { ...
R/visualization.R#L227   } else if (metric == "density_fc") { ...
R/visualization.R#L230   } else { ...
R/visualization.R#L233   } ...
R/visualization.R#L234    ...
R/visualization.R#L235   value_cols <- paste0(rbps, col_suffix) ...
R/visualization.R#L236    ...
R/visualization.R#L237   group_col <- if ("transcript" %in% nam ...
R/visualization.R#L238   if (is.null(group_col)) stop("No trans ...
R/visualization.R#L239    ...
R/visualization.R#L240   data <- results[get(group_col) == tran ...
R/visualization.R#L241    ...
R/visualization.R#L242   if (!is.null(xlim)) { ...
R/visualization.R#L244   } ...
R/visualization.R#L245    ...
R/visualization.R#L246   # Handle window ...
R/visualization.R#L247   if (!is.null(window) && window > 1 &&  ...
R/visualization.R#L256       r <- rbps[i] ...
R/visualization.R#L257       col <- value_cols[i] ...
R/visualization.R#L258       for (j in seq_along(valid_starts)) ...
R/visualization.R#L265           pos = start_pos, RBP = r, Valu ...
R/visualization.R#L267       } ...
R/visualization.R#L272   } else { ...
R/visualization.R#L274                                variable. ...
R/visualization.R#L277   } ...
R/visualization.R#L278    ...
R/visualization.R#L279   title_suffix <- if (!is.null(window) & ...
R/visualization.R#L280    ...
R/visualization.R#L281   p <- ggplot2::ggplot(melted, ggplot2:: ...
R/visualization.R#L287                    axis.title = ggplot2: ...
R/visualization.R#L289   if (!is.null(kmer_labels)) { ...
R/visualization.R#L291       ggplot2::theme(axis.text.x = ggplo ...
R/visualization.R#L292   } else if ("nt" %in% names(data)) { ...
R/visualization.R#L295       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L297       lbls <- labels_dt$nt ...
R/visualization.R#L298       tens_idx <- which(labels_dt$pos %% ...
R/visualization.R#L299       lbls[tens_idx] <- paste0(lbls[tens ...
R/visualization.R#L300       p <- p + ggplot2::scale_x_continuo ...
R/visualization.R#L302   } ...
R/visualization.R#L303    ...
R/visualization.R#L304   return(p) ...
R/visualization.R#L325                       rbp1_concs = NULL) ...
R/visualization.R#L326    ...
R/visualization.R#L327   if (!requireNamespace("ggplot2", quiet ...
R/visualization.R#L328    ...
R/visualization.R#L329   metric <- match.arg(metric) ...
R/visualization.R#L330    ...
R/visualization.R#L331   # Determine which column to use ...
R/visualization.R#L332   if (metric == "occupancy") { ...
R/visualization.R#L335   } else if (metric == "density") { ...
R/visualization.R#L338   } else if (metric == "density_fc") { ...
R/visualization.R#L341   } else { ...
R/visualization.R#L344   } ...
R/visualization.R#L345    ...
R/visualization.R#L346   # Filter by ROI ...
R/visualization.R#L347   dt <- results[pos >= roi_range[1] & po ...
R/visualization.R#L348    ...
R/visualization.R#L349   conc_col_1 <- paste0("Conc_", rbp1) ...
R/visualization.R#L350   conc_col_2 <- paste0("Conc_", rbp2) ...
R/visualization.R#L351    ...
R/visualization.R#L352   if (!all(c(conc_col_1, conc_col_2, "rn ...
R/visualization.R#L354   } ...
R/visualization.R#L355    ...
R/visualization.R#L356   # Filter by rbp1_concs if specified ...
R/visualization.R#L357   if (!is.null(rbp1_concs)) { ...
R/visualization.R#L359   } ...
R/visualization.R#L360    ...
R/visualization.R#L361   # Aggregate: average the pre-calculate ...
R/visualization.R#L362   agg <- dt[, .(Value = mean(get(value_c ...
R/visualization.R#L364    ...
R/visualization.R#L365   rna_vals <- sort(unique(agg$rna_conc)) ...
R/visualization.R#L366   rbp1_vals <- sort(unique(agg[[conc_col ...
R/visualization.R#L367   rbp2_vals <- sort(unique(agg[[conc_col ...
R/visualization.R#L368    ...
R/visualization.R#L369   n_rna <- length(rna_vals) ...
R/visualization.R#L370   n_rbp1 <- length(rbp1_vals) ...
R/visualization.R#L371   n_rbp2 <- length(rbp2_vals) ...
R/visualization.R#L372    ...
R/visualization.R#L373   # Create tile coordinates ...
R/visualization.R#L374   tile_data <- data.table() ...
R/visualization.R#L375    ...
R/visualization.R#L376   for (i in seq_along(rna_vals)) { ...
R/visualization.R#L378       for (k in seq_along(rbp1_vals)) { ...
R/visualization.R#L380                    get(conc_col_1) == rb ...
R/visualization.R#L381                    get(conc_col_2) == rb ...
R/visualization.R#L389           x = x_center, y = y_center, ...
R/visualization.R#L390           width = tile_width * 0.9, heig ...
R/visualization.R#L391           value = val, rbp1_conc = rbp1_ ...
R/visualization.R#L393       } ...
R/visualization.R#L395   } ...
R/visualization.R#L396    ...
R/visualization.R#L397   p <- ggplot2::ggplot(tile_data, ggplot ...
R/visualization.R#L401                                  name =  ...
R/visualization.R#L403                                  name =  ...
R/visualization.R#L405       title = paste("Competition Grid:", ...
R/visualization.R#L406       subtitle = paste("ROI:", roi_range ...
R/visualization.R#L407                        "\nSubdivisions:" ...
R/visualization.R#L411       axis.text = ggplot2::element_text( ...
R/visualization.R#L412       axis.title = ggplot2::element_text ...
R/visualization.R#L413       panel.grid = ggplot2::element_blan ...
R/visualization.R#L415    ...
R/visualization.R#L416   return(p) ...
R/visualization.R#L445    ...
R/visualization.R#L446   if (!requireNamespace("ggplot2", quiet ...
R/visualization.R#L447    ...
R/visualization.R#L448   metric <- match.arg(metric) ...
R/visualization.R#L449    ...
R/visualization.R#L450   # Determine value columns based on met ...
R/visualization.R#L451   if (metric == "occupancy") { ...
R/visualization.R#L455   } else if (metric == "density") { ...
R/visualization.R#L459   } else if (metric == "density_fc") { ...
R/visualization.R#L463   } else { ...
R/visualization.R#L467   } ...
R/visualization.R#L468    ...
R/visualization.R#L469   # Filter by ROI ...
R/visualization.R#L470   dt <- results[pos >= roi_range[1] & po ...
R/visualization.R#L471    ...
R/visualization.R#L472   # Filter by RNA concentration ...
R/visualization.R#L473   if (!is.null(rna_conc)) { ...
R/visualization.R#L476   } else if ("rna_conc" %in% names(dt))  ...
R/visualization.R#L478       stop("Multiple RNA concentrations  ...
R/visualization.R#L480   } ...
R/visualization.R#L481    ...
R/visualization.R#L482   # Filter by other protein concentratio ...
R/visualization.R#L483   if (!is.null(protein_conc)) { ...
R/visualization.R#L485       col <- paste0("Conc_", p_name) ...
R/visualization.R#L486       val <- protein_conc[[p_name]] ...
R/visualization.R#L487       if (col %in% names(dt)) { ...
R/visualization.R#L489       } ...
R/visualization.R#L491   } ...
R/visualization.R#L492    ...
R/visualization.R#L493   # Get concentration columns for X and  ...
R/visualization.R#L494   conc_col_x <- paste0("Conc_", rbp_x) ...
R/visualization.R#L495   conc_col_y <- paste0("Conc_", rbp_y) ...
R/visualization.R#L496    ...
R/visualization.R#L497   if (!all(c(conc_col_x, conc_col_y, col ...
R/visualization.R#L499   } ...
R/visualization.R#L500    ...
R/visualization.R#L501   # Aggregate: average metric values wit ...
R/visualization.R#L502   agg <- dt[, .( ...
R/visualization.R#L505   ), by = c(conc_col_x, conc_col_y)] ...
R/visualization.R#L506    ...
R/visualization.R#L507   # Get unique concentrations ...
R/visualization.R#L508   x_vals <- sort(unique(agg[[conc_col_x] ...
R/visualization.R#L509   y_vals <- sort(unique(agg[[conc_col_y] ...
R/visualization.R#L510    ...
R/visualization.R#L511   # Map to grid indices ...
R/visualization.R#L512   agg$x_idx <- match(agg[[conc_col_x]],  ...
R/visualization.R#L513   agg$y_idx <- match(agg[[conc_col_y]],  ...
R/visualization.R#L514    ...
R/visualization.R#L515   # Create arc data for split dots ...
R/visualization.R#L516   make_arc <- function(cx, cy, r, start_ ...
R/visualization.R#L520   } ...
R/visualization.R#L521    ...
R/visualization.R#L522   # Build polygon data ...
R/visualization.R#L523   poly_data <- data.table() ...
R/visualization.R#L524   counter <- 1 ...
R/visualization.R#L525    ...
R/visualization.R#L526   # Get max values for scaling ...
R/visualization.R#L527   max_val <- max(c(agg$Val_X, agg$Val_Y) ...
R/visualization.R#L528   if (max_val <= 0) max_val <- 1 ...
R/visualization.R#L529    ...
R/visualization.R#L530   for (i in seq_len(nrow(agg))) { ...
R/visualization.R#L542       arc_x <- make_arc(cx, cy, r_x, -pi ...
R/visualization.R#L543       arc_x <- rbind(data.frame(x=cx, y= ...
R/visualization.R#L544       arc_x$group <- counter ...
R/visualization.R#L545       arc_x$RBP <- rbp_x ...
R/visualization.R#L546       arc_x$value <- val_x ...
R/visualization.R#L547       poly_data <- rbind(poly_data, arc_ ...
R/visualization.R#L548       counter <- counter + 1 ...
R/visualization.R#L553       arc_y <- make_arc(cx, cy, r_y, 3*p ...
R/visualization.R#L554       arc_y <- rbind(data.frame(x=cx, y= ...
R/visualization.R#L555       arc_y$group <- counter ...
R/visualization.R#L556       arc_y$RBP <- rbp_y ...
R/visualization.R#L557       arc_y$value <- val_y ...
R/visualization.R#L558       poly_data <- rbind(poly_data, arc_ ...
R/visualization.R#L559       counter <- counter + 1 ...
R/visualization.R#L561   } ...
R/visualization.R#L562    ...
R/visualization.R#L563   # Default colors ...
R/visualization.R#L564   if (is.null(colors)) { ...
R/visualization.R#L567   } ...
R/visualization.R#L568    ...
R/visualization.R#L569   # Extract ROI sequence for subtitle ...
R/visualization.R#L570   if ("nt" %in% names(results)) { ...
R/visualization.R#L574   } else { ...
R/visualization.R#L576   } ...
R/visualization.R#L577    ...
R/visualization.R#L578   # Create size legend data - position t ...
R/visualization.R#L579   n_x <- length(x_vals) ...
R/visualization.R#L580   n_y <- length(y_vals) ...
R/visualization.R#L581    ...
R/visualization.R#L582   # Use custom legend breaks if provided ...
R/visualization.R#L583   if (!is.null(legend_breaks)) { ...
R/visualization.R#L585   } else { ...
R/visualization.R#L587   } ...
R/visualization.R#L588    ...
R/visualization.R#L589   legend_radii <- sqrt(legend_vals / max ...
R/visualization.R#L590   max_radius <- max(legend_radii) ...
R/visualization.R#L591    ...
R/visualization.R#L592   # Position legend left edge (where tit ...
R/visualization.R#L593   legend_left_edge <- n_x + 1.2  # Start ...
R/visualization.R#L594    ...
R/visualization.R#L595   # Position legend circles within the y ...
R/visualization.R#L596   legend_y_spacing <- max(1, (n_y - 1) / ...
R/visualization.R#L597   legend_y_positions <- 1 + legend_y_spa ...
R/visualization.R#L598    ...
R/visualization.R#L599   # Build circles - left edge of each ci ...
R/visualization.R#L600   legend_circles <- data.table() ...
R/visualization.R#L601   for (i in seq_along(legend_vals)) { ...
R/visualization.R#L606       x = circle_center_x + legend_radii ...
R/visualization.R#L607       y = legend_y_positions[i] + legend ...
R/visualization.R#L608       group = 1000 + i, ...
R/visualization.R#L609       RBP = "legend", ...
R/visualization.R#L610       value = legend_vals[i] ...
R/visualization.R#L613   } ...
R/visualization.R#L614    ...
R/visualization.R#L615   # Legend labels - position to the righ ...
R/visualization.R#L616   legend_labels <- data.frame( ...
R/visualization.R#L620   ) ...
R/visualization.R#L621    ...
R/visualization.R#L622   # Position title above the legend circ ...
R/visualization.R#L623   legend_title_y <- max(legend_y_positio ...
R/visualization.R#L624   legend_title_df <- data.frame( ...
R/visualization.R#L628   ) ...
R/visualization.R#L629    ...
R/visualization.R#L630   # Build subtitle ...
R/visualization.R#L631   subtitle_parts <- c(roi_seq, paste("\n ...
R/visualization.R#L632   if (!is.null(rna_conc)) subtitle_parts ...
R/visualization.R#L633   if (!is.null(protein_conc)) { ...
R/visualization.R#L636   } ...
R/visualization.R#L637    ...
R/visualization.R#L638   # Combine main plot data with legend c ...
R/visualization.R#L639   all_poly <- rbind(poly_data, legend_ci ...
R/visualization.R#L640    ...
R/visualization.R#L641   # Plot: use coord_fixed to maintain as ...
R/visualization.R#L642   p <- ggplot2::ggplot(all_poly, ggplot2 ...
R/visualization.R#L646       values = c(colors, "legend" = "gra ...
R/visualization.R#L647       breaks = c(rbp_x, rbp_y), ...
R/visualization.R#L648       name = "RBP" ...
R/visualization.R#L652                        ggplot2::aes(x =  ...
R/visualization.R#L653                        hjust = 0, size = ...
R/visualization.R#L656                        ggplot2::aes(x =  ...
R/visualization.R#L657                        fontface = "bold" ...
R/visualization.R#L659                                  name =  ...
R/visualization.R#L661                                  name =  ...
R/visualization.R#L665       title = paste("Competitive Binding ...
R/visualization.R#L666       subtitle = paste(subtitle_parts, c ...
R/visualization.R#L670       axis.text = ggplot2::element_text( ...
R/visualization.R#L671       axis.title = ggplot2::element_text ...
R/visualization.R#L672       legend.position = "bottom", ...
R/visualization.R#L673       panel.grid = ggplot2::element_blan ...
R/visualization.R#L674       plot.margin = ggplot2::margin(t =  ...
R/visualization.R#L676    ...
R/visualization.R#L677   return(p) ...
R/visualization.R#L701                          bins = 50, colo ...
R/visualization.R#L702   if (!requireNamespace("ggplot2", quiet ...
R/visualization.R#L704   } ...
R/visualization.R#L705    ...
R/visualization.R#L706   metric <- match.arg(metric) ...
R/visualization.R#L707    ...
R/visualization.R#L708   # Select RBPs to plot ...
R/visualization.R#L709   if (is.null(rbp)) { ...
R/visualization.R#L711   } ...
R/visualization.R#L712   missing_rbp <- setdiff(rbp, names(rbp_ ...
R/visualization.R#L713   if (length(missing_rbp) > 0) { ...
R/visualization.R#L715   } ...
R/visualization.R#L716    ...
R/visualization.R#L717   # Build combined data ...
R/visualization.R#L718   plot_data <- data.table::rbindlist(lap ...
R/visualization.R#L723       # Processed model ...
R/visualization.R#L724       if (metric == "Ka") { ...
R/visualization.R#L726       } else { ...
R/visualization.R#L728       } ...
R/visualization.R#L730       # Raw model - score is already nor ...
R/visualization.R#L731       val <- model$score ...
R/visualization.R#L733       stop("Model ", r, " has neither 'K ...
R/visualization.R#L737   })) ...
R/visualization.R#L738    ...
R/visualization.R#L739   # Set RBP factor order ...
R/visualization.R#L740   plot_data[, RBP := factor(RBP, levels  ...
R/visualization.R#L741    ...
R/visualization.R#L742   # Default colors if not provided ...
R/visualization.R#L743   if (is.null(colors)) { ...
R/visualization.R#L745                          "#FFFF33", "#A6 ...
R/visualization.R#L747   } ...
R/visualization.R#L748    ...
R/visualization.R#L749   # Build plot ...
R/visualization.R#L750   p <- ggplot2::ggplot(plot_data, ggplot ...
R/visualization.R#L754       title = paste(metric, "Distributio ...
R/visualization.R#L755       x = if (metric == "Kd") "Kd (nM)"  ...
R/visualization.R#L756       y = "Count", ...
R/visualization.R#L757       fill = "RBP" ...
R/visualization.R#L761       axis.text = ggplot2::element_text( ...
R/visualization.R#L762       axis.title = ggplot2::element_text ...
R/visualization.R#L763       legend.position = "right" ...
R/visualization.R#L765    ...
R/visualization.R#L766   if (log_scale) { ...
R/visualization.R#L768   } ...
R/visualization.R#L769    ...
R/visualization.R#L770   return(p) ...
vignettes/RBPBind-intro.Rmd#L14   echo = TRUE, ...
vignettes/RBPBind-intro.Rmd#L15   collapse = TRUE, ...
vignettes/RBPBind-intro.Rmd#L16   comment = "#>", ...
vignettes/RBPBind-intro.Rmd#L17   fig.width = 7, ...
vignettes/RBPBind-intro.Rmd#L18   fig.height = 5, ...
vignettes/RBPBind-intro.Rmd#L19   warning = FALSE, ...
vignettes/RBPBind-intro.Rmd#L20   message = FALSE ...
vignettes/RBPBind-intro.Rmd#L42    equal chances of interaction with the ...
vignettes/RBPBind-intro.Rmd#L44    RBPs are treated as independent event ...
vignettes/RBPBind-intro.Rmd#L45    concentrations for each binding site. ...
vignettes/RBPBind-intro.Rmd#L148   "HH" = 100, "HL" = 100,  # Ka_max = 10 ...
vignettes/RBPBind-intro.Rmd#L149   "LH" = 10,  "LL" = 10    # Ka_max = 10 ...
vignettes/RBPBind-intro.Rmd#L153   "HH" = 0.001, "HL" = 0.001,  # Ka_min  ...
vignettes/RBPBind-intro.Rmd#L154   "LH" = 0.001, "LL" = 0.001 ...
vignettes/RBPBind-intro.Rmd#L167            bins = 100, alpha = 0.4) ...
vignettes/RBPBind-intro.Rmd#L236   sequence = seq, ...
vignettes/RBPBind-intro.Rmd#L237   rbp_models = rbp_models, ...
vignettes/RBPBind-intro.Rmd#L238   protein_concs = prot_concs, ...
vignettes/RBPBind-intro.Rmd#L239   rna_conc = rna_conc, ...
vignettes/RBPBind-intro.Rmd#L240   k = k_size ...
vignettes/RBPBind-intro.Rmd#L264              transcript = "Custom RNA",  ...
vignettes/RBPBind-intro.Rmd#L271              transcript = "Custom RNA",  ...
vignettes/RBPBind-intro.Rmd#L280              xaxis_type = "both", metric ...
vignettes/RBPBind-intro.Rmd#L314   HH = c(0, 10, 25, 50, 100, 250, 500, 1 ...
vignettes/RBPBind-intro.Rmd#L315   HL = c(0, 10, 25, 50, 100, 250, 500, 1 ...
vignettes/RBPBind-intro.Rmd#L316   LH = c(0, 10, 25, 50, 100, 250, 500, 1 ...
vignettes/RBPBind-intro.Rmd#L317   LL = c(0, 10, 25, 50, 100, 250, 500, 1 ...
vignettes/RBPBind-intro.Rmd#L322   sequence = seq, ...
vignettes/RBPBind-intro.Rmd#L323   rbp_models = rbp_models, ...
vignettes/RBPBind-intro.Rmd#L324   protein_conc_grid = prot_grid, ...
vignettes/RBPBind-intro.Rmd#L325   rna_conc_grid = rna_grid, ...
vignettes/RBPBind-intro.Rmd#L326   k = k_size, ...
vignettes/RBPBind-intro.Rmd#L327   parallel = TRUE ...
vignettes/RBPBind-intro.Rmd#L339   results = res_grid, ...
vignettes/RBPBind-intro.Rmd#L340   rbp = c("HH", "HL", "LH", "LL"), ...
vignettes/RBPBind-intro.Rmd#L341   rna_conc = 10, ...
vignettes/RBPBind-intro.Rmd#L342   protein_conc = c(HH=10, HL=10, LH=1000 ...
vignettes/RBPBind-intro.Rmd#L343   metric = "density" ...
vignettes/RBPBind-intro.Rmd#L354   results = res_grid, ...
vignettes/RBPBind-intro.Rmd#L355   rbp_x = "HH", ...
vignettes/RBPBind-intro.Rmd#L356   rbp_y = "LL", ...
vignettes/RBPBind-intro.Rmd#L357   roi_range = c(29, 33), ...
vignettes/RBPBind-intro.Rmd#L358   rna_conc = 10, ...
vignettes/RBPBind-intro.Rmd#L359   protein_conc = c(HL=0, LH=0), ...
vignettes/RBPBind-intro.Rmd#L360   metric = "density_fc", ...
vignettes/RBPBind-intro.Rmd#L361   colors = c("HH" = "skyblue", "LL" = "s ...
vignettes/RBPBind-intro.Rmd#L378   sequence = seq, ...
vignettes/RBPBind-intro.Rmd#L379   rbp_models = rbp_models_2rbp, ...
vignettes/RBPBind-intro.Rmd#L380   protein_conc_grid = list(HH = c(0, 10, ...
vignettes/RBPBind-intro.Rmd#L381   rna_conc_grid = c(10, 50, 100, 500), ...
vignettes/RBPBind-intro.Rmd#L382   k = k_size, ...
vignettes/RBPBind-intro.Rmd#L383   parallel = TRUE ...
vignettes/RBPBind-intro.Rmd#L387   results = res_grid_2rbp, ...
vignettes/RBPBind-intro.Rmd#L388   rbp1 = "HH", ...
vignettes/RBPBind-intro.Rmd#L389   rbp2 = "LL", ...
vignettes/RBPBind-intro.Rmd#L390   rbp1_concs = c(10, 50, 100, 500), ...
vignettes/RBPBind-intro.Rmd#L391   roi_range = c(29, 33), ...
vignettes/RBPBind-intro.Rmd#L392   metric = "density" ...
vignettes/RBPBind-intro.Rmd#L410   fasta_file = fasta_file, ...
vignettes/RBPBind-intro.Rmd#L411   rbp_models = rbp_models, ...
vignettes/RBPBind-intro.Rmd#L412   protein_concs = c(HH = 100, HL = 100,  ...
vignettes/RBPBind-intro.Rmd#L413   rna_conc = 10, ...
vignettes/RBPBind-intro.Rmd#L414   k = 5 ...
vignettes/RBPBind-intro.Rmd#L428   fasta_file = fasta_file, ...
vignettes/RBPBind-intro.Rmd#L429   rbp_models = rbp_models, ...
vignettes/RBPBind-intro.Rmd#L430   protein_conc_grid = list( ...
vignettes/RBPBind-intro.Rmd#L435   ), ...
vignettes/RBPBind-intro.Rmd#L436   rna_conc_grid = c(10), ...
vignettes/RBPBind-intro.Rmd#L437   k = 5, ...
vignettes/RBPBind-intro.Rmd#L438   parallel = TRUE ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
